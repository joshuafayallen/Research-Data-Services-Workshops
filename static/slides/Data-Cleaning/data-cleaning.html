<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Cleaning and Manipulation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Josh Allen" />
    <meta name="date" content="2022-08-16" />
    <script src="data-cleaning_files/header-attrs-2.14/header-attrs.js"></script>
    <script src="data-cleaning_files/clipboard-2.0.6/clipboard.min.js"></script>
    <link href="data-cleaning_files/shareon-1.4.1/shareon.min.css" rel="stylesheet" />
    <script src="data-cleaning_files/shareon-1.4.1/shareon.min.js"></script>
    <link href="data-cleaning_files/xaringanExtra-shareagain-0.2.6/shareagain.css" rel="stylesheet" />
    <script src="data-cleaning_files/xaringanExtra-shareagain-0.2.6/shareagain.js"></script>
    <link href="data-cleaning_files/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="data-cleaning_files/tile-view-0.2.6/tile-view.js"></script>
    <link href="data-cleaning_files/countdown-0.3.5/countdown.css" rel="stylesheet" />
    <script src="data-cleaning_files/countdown-0.3.5/countdown.js"></script>
    <link rel="stylesheet" href="gsu-css/gsu.css" type="text/css" />
    <link rel="stylesheet" href=" gsu-css/gsu-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Data Cleaning and Manipulation
]
.subtitle[
## In The Tidyverse
]
.author[
### Josh Allen
]
.institute[
### Department of Political Science
]
.institute[
### Georgia State University
]
.date[
### 2022-08-16
]

---


<style>.shareagain-bar {
--shareagain-foreground: rgb(255, 255, 255);
--shareagain-background: rgba(0, 0, 0, 0.5);
}</style>

---
# Packages You Will Need


```r
install.packages("pacman")

pacman::p_load("palmerpenguins", "knitr", "kableExtra", "tidyverse", install = TRUE)

data("starwars")

penguins = penguins
```



---

---
class: center, middle, inverse

# Cleaning Data in the Tidyverse 



---

---
class: center, middle


&lt;gsu-blockquote-red&gt;

Like families, tidy datasets are all alike but every messy dataset is messy in its own way. 
&lt;footer&gt;Hadley Wickham&lt;/footer&gt;

&lt;/gsu-blockquote-red&gt;


---


---
# What is tidy data?

- Every variable is a column

- Every row is an observation

- Each type of observational unit forms a table.

- Most of the time this looks like what is known as "long data"

---


---
# Pros of the Tidyverse

One of the most furious debates in R is base R versus tidyverse. I will not go into great detail about them because many people who are better at R than me have 

- Similar syntax and philosophy which makes it more intuitive to learn

- Extremely nice community

- The core syntax of `dplyr` provides a nice front end for many other big data tools i.e. SQL

- Generally pretty intuitive and easy to figure out what past you has done.
--
However,

do not avoid some base R solutions 

Base R is more stable so it limits the fragility of your code 

A mix of base R and the tidyverse never hurt nobody

---

---
class:center, middle 

```
##  [1] "broom"         "cli"           "crayon"        "dbplyr"       
##  [5] "dplyr"         "dtplyr"        "forcats"       "ggplot2"      
##  [9] "googledrive"   "googlesheets4" "haven"         "hms"          
## [13] "httr"          "jsonlite"      "lubridate"     "magrittr"     
## [17] "modelr"        "pillar"        "purrr"         "readr"        
## [21] "readxl"        "reprex"        "rlang"         "rstudioapi"   
## [25] "rvest"         "stringr"       "tibble"        "tidyr"        
## [29] "xml2"          "tidyverse"
```

???
These are the packages that are considered a part of the tidyerse. The ones that are loaded when you do library tidyverse are ggplot tibble tidyr readr purr dplyr stringr and forcats. Magrittr is also loaded. But if you want anything else like rvest and broom 

---

---
# What is loaded


```r
library(tidyverse)
```

```
## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.8     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter()     masks stats::filter()
## ✖ dplyr::group_rows() masks kableExtra::group_rows()
## ✖ dplyr::lag()        masks stats::lag()
```
- However you can load in specific packages. There is something called the tinyverse that loads in `ggplot2` and `data.table`

???
The tidyverse is pretty verbose because it loads a lot of things and in the case of lag and filter actually makes its lag and filter function the one that R uses. 

---

---



---
# Namespace Conflicts


- Since R is open source you can name your functions just about anything
  - this results in lots of packages having similarly named functions 
  
- `Dplyr` is just warning us that if we use `filter` or `lag` it will use `dplyr`'s version of the function

- Whenever `R` runs into a namespace conflict it will default to the last package that was loaded

- It is generally best practice to load the `tidyverse` last

- You can also use `packagename::function you want to use` to get around it. 
  - This is called a namespace call
  - explicitly tells R which function you are using 






---
class: center, middle 

 
 &lt;figure&gt;
  &lt;img src="https://raw.githubusercontent.com/andrewheiss/2021-seacen/main/01_welcome-tidyverse/slides/img/01/dplyr.png" alt="Dplyr" title="Dplyr" width="20%"&gt;
&lt;/figure&gt;



---


---
# The Big 5 Dplyr Verbs

&lt;table&gt;
  &lt;tr&gt;
    &lt;td&gt;Extract rows with &lt;code&gt;filter()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="https://raw.githubusercontent.com/andrewheiss/2021-seacen/main/01_welcome-tidyverse/slides/img/01/filter.png" alt="filter" title="filter" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Extract columns with &lt;code&gt;select()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="https://raw.githubusercontent.com/andrewheiss/2021-seacen/main/01_welcome-tidyverse/slides/img/01/select.png" alt="select" title="select" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Arrange/sort rows with &lt;code&gt;arrange()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="https://raw.githubusercontent.com/andrewheiss/2021-seacen/main/01_welcome-tidyverse/slides/img/01/arrange.png" alt="arrange" title="arrange" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Make new columns with &lt;code&gt;mutate()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="https://raw.githubusercontent.com/andrewheiss/2021-seacen/main/01_welcome-tidyverse/slides/img/01/mutate.png" alt="mutate" title="mutate" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;Make group summaries with&lt;br&gt;&lt;code&gt;group_by() %&gt;% summarize()&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;img src="https://raw.githubusercontent.com/andrewheiss/2021-seacen/main/01_welcome-tidyverse/slides/img/01/summarize.png" alt="summarize" title="summarize" height="80px"&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;


---

---
# A Common Syntax


.pull-left[



&lt;code class ='r hljs remark-code'&gt;&lt;b&gt;&lt;span style='background-color:#EFB3FF'&gt;VERB&lt;/span&gt;&lt;/b&gt;(&lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;DATA&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;...&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;

]

.pull-right[


- &lt;b&gt;&lt;span style="background: #EFB3FF"&gt;`VERB`&lt;/span&gt;&lt;/b&gt; = dplyr function/verb
- &lt;b&gt;&lt;span style="background: #FFDFD1"&gt;`DATA`&lt;/span&gt;&lt;/b&gt; = Data frame to transform
- &lt;b&gt;&lt;span style="background: #FFD0CF"&gt;`...`&lt;/span&gt;&lt;/b&gt; = Stuff the verb does

]
???
In the intro I mentioned that the tidyverse is great because we have a common way of working with data regardless of the thing we want to do with our data. We determine what verb we want to use. We tell it what data it is working with and what you want to do with it.
---



---
# Piping 

- The pipe is wildly convenient and makes your code much easier to debug

- It is a lot more intuitive than huge nested calls not only to read but to write 

- It is how most people do things in the tidyverse 

???
Rather than starting with nested parenthesis we will start with piping. because it affords us a ton of advantages

---

---
# Magrittr Piping

The tidyverse has its own pipe `%&gt;%` and used to be the only game in town.
  - `%&gt;%` is just `%` followed by `&gt;` followed by `%&gt;%`
  
- A pipe takes whats on the left hand side of the pipe and evaluates it as the *first* argument on the right hand side 



```r
# These do the same thing
summarise(group_by(filter(penguins,species == "Adelie"), island), mean(body_mass_g, na.rm = TRUE))

penguins %&gt;%  filter(species == "Adelie") %&gt;% group_by(island) %&gt;% summarise(mean(body_mass_g, na.rm = TRUE))
```

.footnote[Example provided by [Grant McDermot](https://github.com/uo-ec607/lectures)]
---

---
# Magrittr Piping(cont)

- When you pipe stuff it is easier to think of the pipe as saying and then

- If we use an example from your morning routine we can start to figure it our 

```
me %&gt;%
wake_up(time = "8.00am") %&gt;%
get_out_of_bed(side = "correct") %&gt;%
get_dressed(pants = "TRUE", shirt = "TRUE") %&gt;% 
leave_house(car = TRUE, bike = FALSE, MARTA = FALSE) %&gt;%
am_late(traffic = TRUE)

```



.footnote[Example derived from [Andrew Heiss](https://twitter.com/andrewheiss/status/1359583543509348356?lang=en)]
---


---
# Base R Pipe

- The pipe caught on and the team behind `R` added a native pipe |&gt;
  - this is just `|` followed by `&gt;`

- If you are have a version of R that is older than `4.2.0` it should come with the native pipe

- The base versus magrittr pipe differ slightly and it is worth knowing some of the differences

- The base R pipe is pretty flexible and supports some cool computer sciency stuff for more [check out this page](https://stat.ethz.ch/R-manual/R-devel/library/base/html/pipeOp.html)
  - I tend to use the base R pipe

???
If you are on a mac the keyboard shortcut is command shift m
---

---
class: center, middle, inverse 

# filter()




---
---
# filter()

filter extracts a set of rows that meet a test that you give it

.pull-left[


&lt;code class ='r hljs remark-code'&gt;filter(.data = &lt;b&gt;&lt;span style='background-color:#FFDFD1'&gt;DATA&lt;/span&gt;&lt;/b&gt;, &lt;b&gt;&lt;span style='background-color:#FFD0CF'&gt;...&lt;/span&gt;&lt;/b&gt;)&lt;/code&gt;


]

.pull-right[


- &lt;b&gt;&lt;span style="background: #FFDFD1"&gt;`DATA`&lt;/span&gt;&lt;/b&gt; = Data frame to transform
- &lt;b&gt;&lt;span style="background: #FFD0CF"&gt;`...`&lt;/span&gt;&lt;/b&gt; = One or more tests &lt;br&gt;.small[`filter()` returns each row for which the test is TRUE]


]

---

---
# What Kind of Tests Can I Do?

&lt;table&gt;
  &lt;tr&gt;
    &lt;th class="cell-center"&gt;Test&lt;/th&gt;
    &lt;th class="cell-left"&gt;Meaning&lt;/th&gt;
    &lt;th class="cell-center"&gt;Test&lt;/th&gt;
    &lt;th class="cell-left"&gt;Meaning&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &lt; y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Less than&lt;/td&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x %in% y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;In (group membership)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &gt; y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Greater than&lt;/td&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;is.na(x)&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Is missing&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;==&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Equal to&lt;/td&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;!is.na(x)&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Is not missing&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &lt;= y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Less than or equal to&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x &gt;= y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Greater than or equal to&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="cell-center"&gt;&lt;code class="remark-inline-code"&gt;x != y&lt;/code&gt;&lt;/td&gt;
    &lt;td class="cell-left"&gt;Not equal to&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;



---


---
# filter()


.pull-left[

```r
penguins |&gt; 
  filter(species == "Adelie",
         body_mass_g &lt; 6200,
         bill_length_mm &lt; 59.6)
```
]

.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; body_mass_g &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; bill_length_mm &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3750 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 39.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3800 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 39.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3250 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 40.3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3450 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 36.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3650 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 39.3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 3625 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 38.9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; … &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


]

---


---
# filter()

regular expressions also work and can be pretty handy.

.pull-left[


```r
starwars |&gt; 
  filter(grepl("Skywalker", name)|
           grepl("Palp", name) |
           grepl("Obi", name))
```
]

.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; height &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; mass &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; homeworld &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Luke Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 172 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 77 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Obi-Wan Kenobi &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 182 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 77 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Stewjon &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Anakin Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 188 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 84 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Palpatine &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 170 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 75 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Naboo &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Shmi Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 163 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



]


---

--- 
# filter()

You can also supply a list to filter to subset your data 

.pull-left[

```r
starwars |&gt; 
  filter(homeworld %in% c("Naboo", "Tatooine")
         &amp; !grepl(c("ars"),name))
```
]

.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; homeworld &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Luke Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; C-3PO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2-D2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Naboo &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Darth Vader &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R5-D4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Biggs Darklighter &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



]
???
Using lists instead of big long conditional statements will honestly make 

---


---
# filter()

One of the most common uses is to find and remove missing values or not in a list.


```r
penguins |&gt; 
  filter(is.na(sex))

starwars |&gt; 
  filter(is.na(birth_year))
```

---

---
class: inverse 

# Your Turn 

- Using the sample code from the last slide filter out the NA values. Hint use !

- Using either the star wars or penguins data use `%in%` to get a set of home worlds or islands

- subset the penguin data where body mass is less than `4202` and not on the Dream Island.


---

---
class: center, middle, inverse


# Select()


---


---
# Select()

For various reasons we may want to just keep a few columns.

- For this task we use our friend select 

- You can feed it one column or a range of columns with `:`

- You can also leave columns out using `-`
.pull-left[


```r
penguins |&gt; 
  select(species,
         island:bill_depth_mm,
         -bill_length_mm)
```

]

.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; island &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; bill_depth_mm &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 18.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 17.4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 19.3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 20.6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---


---
# Helpful Helpers 

- Dplyr comes really useful functions that help you when there are common patterns in your variable names

- the syntax usually goes `select(contains("pattern"))`, `select(starts_with("pattern"))`, or `select(ends_with("pattern"))`

.pull-left[

```r
starwars |&gt; 
  select(name, ends_with("color"), homeworld)
```
]


.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; hair_color &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; skin_color &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; eye_color &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; homeworld &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Luke Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; blond &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; fair &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; blue &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; C-3PO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; gold &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yellow &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2-D2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; white, blue &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; red &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Naboo &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Darth Vader &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; none &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; white &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; yellow &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Leia Organa &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; brown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; light &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; brown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Alderaan &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Owen Lars &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; brown, grey &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; light &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; blue &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tatooine &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

]

---

---
# Mutate 


- Mutate creates new columns in your dataset

- You can use logical and boolean operators as well as various mathematical transformations 

.pull-left[

```r
penguins |&gt; 
  filter(!is.na(sex)) |&gt; 
  select(species, sex) |&gt; 
  mutate(female = ifelse(sex == "female", TRUE, FALSE))
```
]

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; sex &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; female &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; FALSE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TRUE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TRUE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TRUE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; FALSE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; TRUE &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

]


---


---
# Mutate() 

- Mutate is order aware so you don't have to use a new `mutate` for each new variable you want to create

.pull-left[

```r
 penguins |&gt; 
  filter(!is.na(bill_length_mm) &amp; species == "Gentoo") |&gt; 
  mutate(long_bill = bill_length_mm * 2,
         long_bill_logical =
           ifelse(long_bill &gt;= 100
                  &amp; long_bill &lt;= 119.20,
                  "Long",
                  "Short")) |&gt; 
  select(species, bill_length_mm, long_bill, long_bill_logical)
```

]


.pull-right[

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; bill_length_mm &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; long_bill &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; long_bill_logical &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 46.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 92.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Short &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Long &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 48.7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 97.4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Short &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Long &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 47.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 95.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Short &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 46.5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 93 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Short &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



]

---

---
class: center, middle, inverse 

# Group_by() and Summarize() 


---


---
# group_by()

- `group_by()` simply puts rows into groups based on values of a column

- Not necessarily the most useful function because nothing really happens when called by itself 


```r
penguins |&gt;
  group_by(species) 
```

--

- Unless you combine it with `summarize()`





.footnote[You may see me use `summarise` this is the same thing as `summarize`. ]

---


---
layout: false 
class:  middle


```r
penguins |&gt; 
  group_by(species) |&gt; 
  summarize(total_penguins = n())
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; total_penguins &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 152 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Chinstrap &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 68 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 124 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



---


---
class: middle
layout: false 
.pull-left[

```r
penguins |&gt; 
  group_by(species) |&gt; 
  summarise(mean_bill_length = mean(bill_length_mm, na.rm = TRUE))
```
]

.pull-right[


&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; mean_bill_length &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 38.7913907284768 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Chinstrap &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 48.8338235294118 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gentoo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 47.5048780487805 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



]
---


---
class: inverse 

# Your Turn 

- Calculate the minimum, maximum, and median for each species of penguin

- what happens if you remove `group_by()`?

- Do the same for the star wars data 


<div class="countdown" id="timer_62fb1ff7" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">03</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>




---


---
class: center, middle


&lt;figure&gt;
  &lt;img src="https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/tidyr.png" alt="tidyverse" title="Tidyr" width="20%"&gt;
&lt;/figure&gt;


---


---
# Reshaphing Data


![](https://raw.githubusercontent.com/gadenbuie/tidyexplain/main/images/tidyr-pivoting.gif)


---
---
# What does this look like in practice? 
 
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; religion &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; &amp;lt;$10k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $10-20k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $20-30k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $30-40k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $40-50k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $50-75k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $75-100k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; $100-150k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; &amp;gt;150k &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Don't know/refused &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Agnostic &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 81 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 76 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 137 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 122 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 109 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 84 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 96 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Atheist &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 70 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 73 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 59 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 74 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 76 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Buddhist &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 58 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 62 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Catholic &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 418 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 617 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 732 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 670 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 638 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1116 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 949 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 792 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 633 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1489 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Don’t know/refused &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 116 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Evangelical Prot &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 575 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 869 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1064 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 982 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 881 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1486 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 949 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 723 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 414 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1529 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hindu &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 48 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 54 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Historically Black Prot &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 228 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 244 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 236 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 238 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 197 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 223 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 131 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 81 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 78 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 339 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jehovah's Witness &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jewish &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 87 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 151 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 162 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mainline Prot &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 289 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 495 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 619 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 655 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 651 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1107 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 939 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 753 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 634 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1328 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mormon &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 48 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 51 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 112 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 85 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 69 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Muslim &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Orthodox &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 38 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 73 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Other Christian &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Other Faiths &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 41 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Other World Religions &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Unaffiliated &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 217 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 299 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 374 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 365 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 341 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 528 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 407 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 321 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 258 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 597 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
 
???
Lets take a look at some wide data here we are looking at billboard top hits. I have truncated it a bit to fit on the slide but weeks goes to week 47. Instead of having each week be an individual column we want it to be in a tidy format where week is one column and the values from all those columns are in the week column we create 
---




---


```r
relig_income |&gt; 
  pivot_longer(!religion, names_to = "income", values_to = "count" )
```

```
## # A tibble: 180 × 3
##    religion income             count
##    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
##  1 Agnostic &lt;$10k                 27
##  2 Agnostic $10-20k               34
##  3 Agnostic $20-30k               60
##  4 Agnostic $30-40k               81
##  5 Agnostic $40-50k               76
##  6 Agnostic $50-75k              137
##  7 Agnostic $75-100k             122
##  8 Agnostic $100-150k            109
##  9 Agnostic &gt;150k                 84
## 10 Agnostic Don't know/refused    96
## # … with 170 more rows
## # ℹ Use `print(n = ...)` to see more rows
```



```r
head(billboard)
```

```
## # A tibble: 6 × 79
##   artist  track date.ent…¹   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8   wk9
##   &lt;chr&gt;   &lt;chr&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 2 Pac   Baby… 2000-02-26    87    82    72    77    87    94    99    NA    NA
## 2 2Ge+her The … 2000-09-02    91    87    92    NA    NA    NA    NA    NA    NA
## 3 3 Door… Kryp… 2000-04-08    81    70    68    67    66    57    54    53    51
## 4 3 Door… Loser 2000-10-21    76    76    72    69    67    65    55    59    62
## 5 504 Bo… Wobb… 2000-04-15    57    34    25    17    17    31    36    49    53
## 6 98^0    Give… 2000-08-19    51    39    34    26    26    19     2     2     3
## # … with 67 more variables: wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;, wk13 &lt;dbl&gt;,
## #   wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;, wk19 &lt;dbl&gt;,
## #   wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;, wk25 &lt;dbl&gt;,
## #   wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;, wk31 &lt;dbl&gt;,
## #   wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;, wk37 &lt;dbl&gt;,
## #   wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, wk43 &lt;dbl&gt;,
## #   wk44 &lt;dbl&gt;, wk45 &lt;dbl&gt;, wk46 &lt;dbl&gt;, wk47 &lt;dbl&gt;, wk48 &lt;dbl&gt;, wk49 &lt;dbl&gt;, …
## # ℹ Use `colnames()` to see all variable names
```

```r
billboard |&gt; 
  pivot_longer( cols = starts_with("wk"),  names_to = "Week",, names_prefix = "wk"  , values_to = "rank")
```

```
## # A tibble: 24,092 × 5
##    artist track                   date.entered Week   rank
##    &lt;chr&gt;  &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;
##  1 2 Pac  Baby Don't Cry (Keep... 2000-02-26   1        87
##  2 2 Pac  Baby Don't Cry (Keep... 2000-02-26   2        82
##  3 2 Pac  Baby Don't Cry (Keep... 2000-02-26   3        72
##  4 2 Pac  Baby Don't Cry (Keep... 2000-02-26   4        77
##  5 2 Pac  Baby Don't Cry (Keep... 2000-02-26   5        87
##  6 2 Pac  Baby Don't Cry (Keep... 2000-02-26   6        94
##  7 2 Pac  Baby Don't Cry (Keep... 2000-02-26   7        99
##  8 2 Pac  Baby Don't Cry (Keep... 2000-02-26   8        NA
##  9 2 Pac  Baby Don't Cry (Keep... 2000-02-26   9        NA
## 10 2 Pac  Baby Don't Cry (Keep... 2000-02-26   10       NA
## # … with 24,082 more rows
## # ℹ Use `print(n = ...)` to see more rows
```

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true,
"navigation": {
"scroll": true
}
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
